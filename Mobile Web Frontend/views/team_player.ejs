<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" href="images/favicon.ico">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="ScreenOrientation" content="autoRotate:disabled">
    <title>Team - MyTourney</title>
</head>
    <body>
    <div class="navbar" id="nav_bar">
        <nav>
            <ul class="nav-links">
                <li><a href="profile_player">PROFILE</a></li>
                <li><a href="balance">BALANCE</a></li>
                <li><a href="friends">FRIENDS</a></li>
                <li><a href="home">HOME</a></li>
            </ul>
        </nav>
    </div>
    <br><br>
    <div id="copied-msg">
        <div id="copied-msg-textbox">
            LINK COPIED
        </div>
    </div>
    <div id="edit-team-cont">
        <div id="x_btn_cont">
            <img src="https://visualpharm.com/assets/860/Close%20Window-595b40b75ba036ed117d9309.svg" id="x_btn_img" onclick="hideForm()">
        </div>
        <form method="POST" action="/edit_team" enctype="multipart/form-data">
            <div class="form-group">
                <input name="teamname" type="text" class="form-control" id="exampleInputUsername1" placeholder="TEAM NAME">
            </div>
            <label for="teamlogo" style="color: #303549; font-weight: 500;">
                TEAM LOGO
            </label>
            <div class="form-group">
                <input type="file" name="teamlogo" style="width: 100%;
                font-size: 18px;
                padding: 15px;
                margin: 8px 0;
                display: inline-block;
                border: 1px solid #ccc;
                border-radius: 4px;
                box-sizing: border-box;">
            </div>
            <div class="form-group">
                <input style="margin-top: 10px;" type="submit" id="submit-btn-reg" value="REGISTER">
            </div>
        </form>
    </div>
    <div>
        <h1 style="font-family: Varsity; color: #91c2e7; padding: 15px; font-size: 36px; text-align: center; font-weight: 300;">
        <%= team[0].team_name.toUpperCase() %> 
        </h1>
    </div>
    <div id="teamlogo_container">
        <img src="<%= team_path %>/<%= team[0].team_logo %>" id="team-logo-img">
    </div>
    <div class="balance-tourney-join-container" style="background-color: #f45b6a; border-radius: 10px; margin: 15px 15px 0 15px;">
        <div class="balance-tourney-join" id="balance-tourney-join-outer">
            <div style="font-size: 8vw; font-weight: 500;" class="balance-tourney-join-inner">
                TEAM
            </div>
            <div style="font-size: 4vw; font-weight: 500;" class="balance-tourney-join-inner">
                BALANCE
            </div>
        </div>
        <div class="balance-tourney-join" style="font-weight: 500; font-size: 10vw">
            $<%= team[0].team_balance.toFixed(2) %> 
        </div>
        <div  class="balance-tourney-join">
            <div style="background-color: #6c2737; padding: 5px; border-radius: 8px;">
                <a href="/balance" style="font-family: NTF-Grand; font-size: 6vw; color: #91c2e7;">Add Funds</a>
            </div>
        </div>
    </div>
    <div class="container">
        <% for (var member of members){ %>
            <div class="team-member" style="margin-top: 5px;">
                <div class="flex-child img">
                    <% if(member.photo === undefined || member.photo === null) {%> 
                    <img src="https://pbs.twimg.com/media/EJ0BSc7XsAEpIKR.jpg" id="team-member-prof-pic">
                    <% }else{ %> 
                        <img src="<%= profile_path %>/<%= member.photo %>"   id="team-member-prof-pic">
                    <% } %> 
                </div>
                <div class="flex-child info" style="color: #303549; font-size: 18px; font-weight: 500;">
                    <%= member.user_name.toUpperCase() %> </br>
                    <% var age = getAge(member.age); %> 
                    <%= age %> YRS </br>
                    <% if(member.user_id == team[0].users_user_id){ %> 
                        CAPTAIN ðŸŽ–</br>
                    <% } %> 
                </div>
                <% if(member.user_id != team[0].users_user_id && user_id == team[0].users_user_id){ %> 
                    <div class="rem_team_member_cont">
                        <img src="images/trashcan.png" class="rem_team_member" onclick="removeMember('<%= member.user_id %>', '<%= team[0].teams_id %>')">
                    </div>
                <% } %> 
            </div>
        <% } %>
        <% if(user_id == team[0].users_user_id) {%>
            <div style="margin: auto; text-align: center; background-color: #91c2e7; border-radius: 15px; color: #303549; padding-top: 15px; padding-bottom: 15px; margin-bottom: 15px;" onclick="copyLink('<%= team[0].teams_id %>', '<%= url %>')">
                INVITE TEAM MEMBERS
            </div>
            <div style="margin: auto; text-align: center; background-color: #91c2e7; border-radius: 15px; color: #303549; padding-top: 15px; padding-bottom: 15px; margin-bottom: 15px;" onclick="editTeamForm()">
                EDIT TEAM
            </div>
        <% } %>
    </div>

    <script>
        async function copyLink(team_id, url) {
            var current_link = window.location.href;
            var inputc = document.body.appendChild(document.createElement("input"));
            inputc.value = `/join_team?team_id=${team_id}`;
            inputc.focus();
            inputc.select();
            if(navigator.share){
                navigator.share({
                    title: "Join my team on MyTourney!",
                    url: `/join_team?team_id=${team_id}`
                })
            }else{
                document.execCommand('copy');
                var link = document.getElementById('copied-msg');
                fadeIn(link);
                setTimeout(function(){ fadeOut(link); }, 1000);
                setTimeout(function(){ removeLink(link); }, 3000);

            }
            inputc.parentNode.removeChild(inputc);
        }

        function fadeOut(link){
            link.className = "fade-out"
        }

        function removeLink(link){
            link.style.display = 'none'
        }

        function fadeIn(link){
            link.style.display = 'table'
            link.className = "fade-in"
        }

        function hideForm(){
            var form = document.getElementById("edit-team-cont");
            form.style.display = "none";
        }

        function editTeamForm(){
            var form = document.getElementById("edit-team-cont");
            form.style.display = "block";
        }
    </script>
    <script src="annihilator.js"></script>
    </body>
</html>